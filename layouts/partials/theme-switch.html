<button id="theme-toggle"
        class="theme-toggle"
        type="button"
        aria-label="Switch between dark and bright themes">
  <span class="theme-toggle__icon sun">‚òÄÔ∏è</span>
  <span class="theme-toggle__icon moon">üåô</span>
</button>

<script>
  (function () {
    const storageKey = 'typo-color-mode';
    const toggle = document.getElementById('theme-toggle');

    if (!toggle) return;

    function isDark() {
      return document.body.classList.contains('dark');
    }

    function syncHtmlDataTheme() {
      const html = document.documentElement;
      html.setAttribute('data-theme', isDark() ? 'dark' : 'light');
    }

    function applyStoredPreference() {
      const stored = localStorage.getItem(storageKey);
      if (!stored) {
        syncHtmlDataTheme();
        return;
      }

      const wantsDark = stored === 'dark';

      if (typeof invertBody === 'function' && wantsDark !== isDark()) {
        invertBody();
      } else if (typeof invertBody !== 'function') {
        document.body.classList.toggle('dark', wantsDark);
        document.body.classList.toggle('light', !wantsDark);
      }

      syncHtmlDataTheme();
    }

    toggle.addEventListener('click', function () {
      if (typeof invertBody === 'function') {
        invertBody();
      } else {
        document.body.classList.toggle('dark');
        document.body.classList.toggle('light');
      }

      const theme = isDark() ? 'dark' : 'light';
      localStorage.setItem(storageKey, theme);
      syncHtmlDataTheme();
    });

    document.addEventListener('DOMContentLoaded', applyStoredPreference);
  })();
</script>

<style>
    
.theme-toggle {
  position: absolute;
  top: 3.5rem;
  left: 27%;
  transform: translateX(300px);
  z-index: 50;

  background: none;
  border: none;
  cursor: pointer;

  display: flex;
  align-items: center;
  gap: 0.3rem;

  font-size: 1.1rem;
  opacity: 0.8;
  transition: opacity 0.2s ease;
}

.theme-toggle:hover {
  opacity: 0.5;
}

.theme-toggle__icon {
  font-size: 1.2rem;
  line-height: 1;
}

.theme-toggle__icon.sun,
.theme-toggle__icon.moon {
  display: none;
}

html[data-theme="light"] .theme-toggle__icon.moon {
  display: inline;
}

html[data-theme="dark"] .theme-toggle__icon.sun {
  display: inline;
}

@media (max-width: 700px) {
  .theme-toggle {
    top: 0.4rem;
    left: auto;
    right: 6rem;
    transform: none;

    font-size: 1.1rem;
  }
}

</style>